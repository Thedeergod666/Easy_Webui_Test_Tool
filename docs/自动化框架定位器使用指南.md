### **自动化框架定位器使用指南 (V1.01)**

#### **定位器与关键字的关系**

在我们的框架中，元素定位是通过`定位方式`和`目标对象`这两列来定义的。它们是所有**需要与页面元素交互**的关键字的“眼睛”。以下是主要使用这套定位系统的关键字：

*   **核心交互**: `click`, `on_input`, `press`, `clear_input`
*   **高级交互**: `hover`, `drag_and_drop`, `click_at_position` (相对定位模式)
*   **验证与等待**: `verify` (所有`element_...`类型), `wait_until`, `screenshot`

当你使用这些关键字时，框架内部会调用 `_get_locator` 方法，根据你选择的 `定位方式` 来解析 `目标对象`，最终找到页面上独一无二的那个元素。

---

### **定位策略详解与案例**

以下是框架支持的所有定位方式，按**官方推荐度和使用场景**排序：

#### 1. **get\_by\_role** - 语义化定位 (官方首推)
**原理**: 依据 W3C 标准的 [ARIA roles](https://www.w3.org/TR/wai-aria-1.1/#role_definitions) 来定位。它模拟了辅助功能技术（如屏幕阅读器）如何识别页面，因此是最稳定、最可靠的定位方式。它让你用“人话”来描述元素。
**最佳实践**: 只要元素有明确的角色（按钮、链接、输入框、标题等），就**永远优先使用 `get_by_role`**。

| 编号 | 页面 | 关键字 | 验证类型| 定位方式 | 目标对象 | 数据内容 | 描述 |
|:--- |:--- |:--- |:--- |:--- |:--- |:--- |:--- |
| case_r01 | | `click` | | `get_by_role` | `button, name="登录"` | | 点击一个名为“登录”的按钮 |
| case_r02 | | `verify`| `element_visible` | `get_by_role`| `heading, name="欢迎回来"` | | 验证名为“欢迎回来”的H1-H6标题可见 |
| case_r03 | | `on_input`| | `get_by_role`| `textbox, name="电子邮件"` | `test@qq.com` | 在一个关联了“电子邮件”标签的输入框中输入 |
| case_r04 | | `click` | | `get_by_role`| `link, name="编辑" .nth(2)` | | (高级) 点击页面上第三个名为“编辑”的链接 |
| case_r05 | | `click` | | `get_by_role`| `checkbox`| `name="我已阅读并同意"` | (高级) 通过`数据内容`列添加额外筛选条件 |

---
#### 2. **get\_by\_text**, **get\_by\_label**, **get\_by\_placeholder** - 面向用户的文本定位
**原理**: 这些方式直接通过用户在界面上能看到的文本来定位，非常直观。
*   `get_by_text`: 通过元素自身的可见文本。
*   `get_by_label`: 通过与元素关联的`<label>`标签的文本。
*   `get_by_placeholder`: 通过输入框的占位符文本。
**最佳实践**: 当元素没有明确的`role`但有独特的可见文本时，这些是绝佳的选择。

| 编号 | 页面 | 关键字 | 验证类型| 定位方式 | 目标对象 | 数据内容 | 描述 |
|:--- |:--- |:--- |:--- |:--- |:--- |:--- |:--- |
| case_t01 | | `click` | | `get_by_text` | `查看我的购物车` | | 点击文本为“查看我的购物车”的元素 |
| case_t02 | | `on_input`| | `get_by_label`| `确认密码` | `Pass123!@#` | 在“确认密码”标签对应的输入框中输入 |
| case_t03 | | `verify`| `element_visible`| `get_by_placeholder`| `请输入商品关键词...`| | 验证有特定占位符的搜索框可见 |

---
#### 3. **css** - CSS选择器
**原理**: 使用标准的CSS选择器语法来定位元素。它非常灵活，几乎无所不能。
**最佳实践**: 当语义化定位不好用时，CSS选择器是可靠的备选方案。尤其适合通过 ID (`#`), class (`.`), 或属性 (`[data-test-id="..."]`) 来定位。

| 编号 | 页面 | 关键字 | 验证类型| 定位方式 | 目标对象 | 数据内容 | 描述 |
|:--- |:--- |:--- |:--- |:--- |:--- |:--- |:--- |
| case_c01 | | `click` | | `css` | `#submit-button` | | 点击ID为 submit-button 的元素 |
| case_c02 | | `on_input`| | `css` | `input[name='user_email']` | `my.email@me.com` | 通过name属性定位输入框并输入 |
| case_c03 | | `verify`| `element_visible`| `css`| `div.error-message`| | 验证class为error-message的div可见 |

---
#### 4. **chain** - 框架特色：链式定位
**原理**: 允许你将多个CSS选择器用 `>>` 连接起来，形成一个清晰的父子关系查找链。
**最佳实践**: 当一个元素本身没有唯一标识，但它在一个有唯一标识的“容器”元素内部时，使用链式定位可以极大地提高定位的稳定性和可读性。

| 编号       | 页面  | 关键字      | 验证类型                  | 定位方式    | 目标对象                                   | 数据内容     | 描述                    |
| :------- | :-- | :------- | :-------------------- | :------ | :------------------------------------- | :------- | :-------------------- |
| case_h01 |     | `click`  |                       | `chain` | `div#user-card-123 >> button.edit-btn` |          | 点击用户ID为123的卡片内的“编辑”按钮 |
| case_h02 |     | `verify` | `element_text_equals` | `chain` | `tr.product-row-45 >> td.price`        | `¥99.99` | 验证ID为45的商品行内的价格       |

---
#### 5. **codegen** - 终极武器：Playwright Inspector代码定位
**原理**: 直接执行一段从Playwright Inspector复制的、不包含`page.`前缀的定位代码。
**最佳实践**: 当遇到极其复杂的定位场景，例如需要用`.filter()`筛选、或混合多种定位方式时，这是你的终极解决方案。**它拥有Playwright定位器的全部能力**。

| 编号 | 页面 | 关键字 | 验证类型| 定位方式 | 目标对象 | 数据内容 | 描述 |
|:--- |:--- |:--- |:--- |:--- |:--- |:--- |:--- |
| case_g01 | | `click` | | `codegen`| `locator("li").filter(has_text="苹果").get_by_role("button", name="添加")` | | 点击包含“苹果”文本的列表行内的“添加”按钮 |
| case_g02 | | `verify`| `element_visible`| `codegen`| `get_by_test_id("main-content").locator("p").nth(3)`| | 验证主内容区域的第四个p段落可见 |

---
#### 6. **xpath** - XPath路径
**原理**: 使用XML路径语言来定位。它功能强大，尤其擅长处理复杂的父/子/兄弟节点关系。
**最佳实践**: 尽量避免使用。虽然强大，但XPath表达式通常很长且可读性差，一旦页面结构微调就容易失效。只有在CSS无法实现（如根据子节点文本查找父节点）的极端情况下才考虑使用。

| 编号 | 页面 | 关键字 | 验证类型| 定位方式 | 目标对象 | 数据内容 | 描述 |
|:--- |:--- |:--- |:--- |:--- |:--- |:--- |:--- |
| case_x01 | | `click` | | `xpath`| `//button[contains(., "保存")]` | | (不推荐) 点击一个文本包含“保存”的按钮 |
