# WEBUIè‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ä½¿ç”¨æŒ‡å—
è¿™æ˜¯ä¸€ä¸ªåŸºäº [Playwright](https://playwright.dev/python/) å’Œ [Pytest](https://docs.pytest.org/) æ„å»ºçš„ **å…³é”®å­—+æ•°æ®é©±åŠ¨çš„ Web UI è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶**ã€‚
å…¶æ ¸å¿ƒç›®æ ‡æ˜¯é€šè¿‡ç®€æ´çš„ Excel è¡¨æ ¼æ¥ç®¡ç†å’Œæ‰§è¡Œå¤æ‚çš„ Web UI æµ‹è¯•æµç¨‹ï¼Œé€‚ç”¨äºå„ç±»å¹³å°çš„å›å½’å’Œå†’çƒŸæµ‹è¯•ï¼Œæ˜¾è‘—é™ä½è‡ªåŠ¨åŒ–æµ‹è¯•çš„é—¨æ§›å’Œç»´æŠ¤æˆæœ¬ã€‚
## æ ¸å¿ƒç‰¹è‰²
* **æç®€ç”¨ä¾‹ç¼–å†™**ï¼šæµ‹è¯•æ­¥éª¤å­˜å‚¨åœ¨ **Excel** ä¸­ï¼Œä¸šåŠ¡äººå‘˜ä¹Ÿèƒ½è½»æ¾å‚ä¸ã€‚
* **å¼ºå¤§çš„ Playwright é›†æˆ**ï¼šå……åˆ†åˆ©ç”¨ Playwright çš„è·¨æµè§ˆå™¨æ”¯æŒã€è‡ªåŠ¨ç­‰å¾…ã€å¼ºå¤§çš„ `get_by_role` è¯­ä¹‰åŒ–å®šä½ç­‰ç‰¹æ€§ã€‚
* **çµæ´»çš„å…³é”®å­—é©±åŠ¨**ï¼šå°è£…äº†ä¸°å¯Œçš„ UI æ“ä½œå…³é”®å­—ï¼ˆç‚¹å‡»ã€è¾“å…¥ã€éªŒè¯ã€å¤š Tab ç®¡ç†ç­‰ï¼‰ï¼Œæ”¯æŒé“¾å¼å®šä½å’Œ Playwright Codegen ç›´æ¥å¯¼å…¥ã€‚
* **æ™ºèƒ½æ‰§è¡Œä¸é…ç½®**ï¼šé€šè¿‡ `test_config.json` çµæ´»é…ç½®æµ‹è¯•æµç¨‹ã€ç›®æ ‡æµè§ˆå™¨ã€æœ‰å¤´/æ— å¤´æ¨¡å¼ç­‰ï¼›å†…ç½® Function (è½¯æ–­è¨€) å’Œ Session (ç¡¬æ–­è¨€) ä¸¤ç§æ‰§è¡Œæ¨¡å¼ã€‚
* **ä¾¿æ·çš„ç¯å¢ƒä¸æµ‹è¯•ç®¡ç†**ï¼šæä¾› `install.bat/.sh` è„šæœ¬ä¸€é”®é…ç½®ç¯å¢ƒï¼Œ`main.bat/.sh` è„šæœ¬ç»Ÿä¸€ç®¡ç†æµ‹è¯•æ‰§è¡Œå…¥å£ï¼ˆæ”¯æŒäº¤äº’å¼ä¸å‘½ä»¤è¡Œè°ƒç”¨ï¼‰ã€‚
* **é«˜æ•ˆçš„ç”¨ä¾‹ç”Ÿæˆ**ï¼šå†…ç½®å·¥å…·å¯å°† Playwright Codegen å½•åˆ¶çš„è„šæœ¬ä¸€é”®è½¬æ¢ä¸º Excel æµ‹è¯•ç”¨ä¾‹ã€‚
## å¿«é€Ÿå¼€å§‹
åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ çš„ç”µè„‘ä¸Šå·²ç»å®‰è£…äº† Python 3.11æˆ–è€…æ›´é«˜ç‰ˆæœ¬ï¼ˆ æ¨è Python 3.13.1ï¼Œæˆ‘å¼€å‘ç¯å¢ƒç”¨çš„å°±æ˜¯è¿™ä¸ª ï¼‰å’Œå¯¹åº”çš„ pip ç‰ˆæœ¬ï¼Œå¹¶å°† Python è·¯å¾„æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­ã€‚
#### é¦–æ¬¡ä½¿ç”¨
1. åŒå‡»è¿è¡Œ `install.bat` æ–‡ä»¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä¸ºä½ é…ç½®å¥½æ‰€æœ‰ç¯å¢ƒã€‚
   macos/linuxç³»ç»Ÿç”¨æˆ·è¯·åœ¨å‘½ä»¤è¡Œé‡Œè¾“å…¥`chmod +x *.sh` åå†è¿è¡Œ`intall.sh`æ–‡ä»¶ã€‚
2. ç­‰å¾…æ‰€æœ‰å®‰è£…å®Œæˆï¼Œçœ‹åˆ°æˆåŠŸæç¤ºåæŒ‰ä»»æ„é”®å…³é—­çª—å£ã€‚
#### æ—¥å¸¸è¿è¡Œæµ‹è¯•
1. ä¿®æ”¹ `test_data` ç›®å½•ä¸‹çš„ Excel æ–‡ä»¶æ¥ç¼–å†™ä½ çš„æµ‹è¯•ç”¨ä¾‹ã€‚
2. ä¿®æ”¹ `test_data` ç›®å½•ä¸‹çš„ `test_config.json` æ–‡ä»¶æ¥å¯ç”¨æˆ–ç¦ç”¨ä½ æƒ³æµ‹è¯•çš„æµç¨‹ã€åˆ‡æ¢æœ‰å¤´æ— å¤´æ¨¡å¼ï¼Œä»¥åŠé…ç½®æµ‹è¯•æµè§ˆå™¨å†…æ ¸ã€‚
3. åŒå‡»è¿è¡Œ `run_tests.bat` æ–‡ä»¶ã€‚
   macos/linuxç³»ç»Ÿä¸‹åŒå‡»è¿è¡Œ`run_tests.sh`æ–‡ä»¶ã€‚
4. æµ‹è¯•ç»“æŸåï¼Œåœ¨ `reports` æ–‡ä»¶å¤¹é‡Œä¼šç”Ÿæˆä¸€ä¸ª `report.html` æ–‡ä»¶ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€å³å¯æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Šã€‚
#### è¿›é˜¶å‚è€ƒ
* [ğŸ”§ å…³é”®å­—å‚è€ƒ (Keyword Reference)](./docs/è‡ªåŠ¨åŒ–æ¡†æ¶å…³é”®å­—ä½¿ç”¨æŒ‡å—.md)ï¼šæ‰€æœ‰å¯ç”¨å…³é”®å­—çš„è¯¦ç»†è¯´æ˜ã€å‚æ•°å’Œä½¿ç”¨ç¤ºä¾‹ã€‚
* [ğŸ“ å®šä½å™¨å‚è€ƒ (Locator Reference)](./docs/è‡ªåŠ¨åŒ–æ¡†æ¶å®šä½å™¨ä½¿ç”¨æŒ‡å—.md)ï¼šè¯¦è§£æ¡†æ¶æ”¯æŒçš„å„ç§å…ƒç´ å®šä½ç­–ç•¥åŠæœ€ä½³å®è·µã€‚
#### æ›´æ–°æ¡†æ¶
- å¦‚æœæ¡†æ¶æœ‰æ›´æ–°ï¼Œä½ éœ€è¦è”ç³»å¼€å‘äººå‘˜è·å–æœ€æ–°çš„ä»£ç åŒ…ï¼Œä¸€èˆ¬æ¥è¯´è§£å‹åè¦†ç›–å°±è¡Œã€‚

## æ¡†æ¶ä»‹ç»
#### æ¡†æ¶ä¸»è¦ç‰¹ç‚¹
1. **é…ç½®ç®¡ç†**ï¼šä½¿ç”¨JSONæ–‡ä»¶ï¼ˆtest_config.jsonï¼‰ç®¡ç†æµ‹è¯•æµç¨‹ã€æµè§ˆå™¨è®¾ç½®ç­‰ã€‚
2. **ç¯å¢ƒå®‰è£…**ï¼šæä¾›äº†install.batï¼ˆWindowsï¼‰å’Œinstall.shï¼ˆmacOS/Linuxï¼‰è„šæœ¬ï¼Œç”¨äºä¸€é”®å®‰è£…ä¾èµ–å’Œæµè§ˆå™¨é©±åŠ¨ã€‚
3. **æµ‹è¯•æ‰§è¡Œ**ï¼šæä¾›äº†main.batå’Œmain.shè„šæœ¬ï¼Œæ”¯æŒäº¤äº’å¼å’Œéäº¤äº’å¼ï¼ˆCI/CDï¼‰ä¸¤ç§æ¨¡å¼ï¼Œå¯ä»¥é€‰æ‹©Functionæ¨¡å¼ï¼ˆè½¯æ–­è¨€ï¼‰æˆ–Sessionæ¨¡å¼ï¼ˆç¡¬æ–­è¨€ï¼‰ã€‚
4. **å…³é”®å­—é©±åŠ¨**ï¼šKeywords.pyå®šä¹‰äº†ä¸°å¯Œçš„å…³é”®å­—ï¼Œå¦‚ç‚¹å‡»ã€è¾“å…¥ã€éªŒè¯ç­‰ï¼Œå¹¶æ”¯æŒå¤šé¡µé¢æ“ä½œå’Œå¤šç§å®šä½æ–¹å¼ï¼ˆåŒ…æ‹¬Playwrightçš„get_by_roleç­‰é«˜çº§å®šä½ï¼‰ã€‚
5. **æµ‹è¯•ç”¨ä¾‹ç®¡ç†**ï¼šæµ‹è¯•ç”¨ä¾‹å­˜å‚¨åœ¨Excelæ–‡ä»¶ä¸­ï¼Œé€šè¿‡pytestè¯»å–å¹¶æ‰§è¡Œã€‚
6. **æŠ¥å‘Šç”Ÿæˆ**ï¼šæµ‹è¯•ç»“æŸåç”ŸæˆHTMLæŠ¥å‘Šï¼ŒæŠ¥å‘Šæ–‡ä»¶ååŒ…å«æ—¶é—´æˆ³å’Œæµ‹è¯•ç»“æœçŠ¶æ€ï¼ˆPassed/Failedï¼‰ã€‚
7. **å¤šæµè§ˆå™¨æ”¯æŒ**ï¼šæ”¯æŒChromium, Firefox, WebKitã€‚
8. **è½¯æ–­è¨€å’Œç¡¬æ–­è¨€**ï¼šFunctionæ¨¡å¼ï¼ˆè½¯æ–­è¨€ï¼‰ä¼šæ”¶é›†æ‰€æœ‰é”™è¯¯å¹¶åœ¨æœ€åç»Ÿä¸€æŠ¥å‘Šï¼›Sessionæ¨¡å¼ï¼ˆç¡¬æ–­è¨€ï¼‰åˆ™åœ¨æ¯ä¸€æ­¥å¤±è´¥æ—¶ç«‹å³åœæ­¢ã€‚
æ­¤å¤–ï¼Œæ¡†æ¶è¿˜åŒ…å«äº†ä¸€äº›**é«˜çº§åŠŸèƒ½**ï¼š
- **å¤šé¡µé¢åˆ‡æ¢**ï¼ˆswitch_to_pageï¼‰
- å…³é—­é¡µé¢ï¼ˆclose_pageï¼‰
- åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼ˆopen_in_new_pageï¼‰
- **æ‰§è¡ŒPlaywright Codegenç”Ÿæˆçš„ä»£ç **ï¼ˆexpect_codegenï¼‰
- å¼ºåˆ¶ç­‰å¾…ï¼ˆsleepï¼‰åœ¨æ— å¤´æ¨¡å¼ä¸‹è‡ªåŠ¨è·³è¿‡ï¼Œå¹¶è®°å½•æ€»ç­‰å¾…æ—¶é—´

#### ç›®å½•æ–‡ä»¶ä»‹ç»
*   `.` (é¡¹ç›®æ ¹ç›®å½•)
    *   `.venv/` - è™šæ‹Ÿç¯å¢ƒï¼Œç”± `install.bat` / `install.sh` è‡ªåŠ¨ç”Ÿæˆã€‚
    *   `docs/` - ä½¿ç”¨æ–‡æ¡£ã€‚
    *   `framework/` - æ¶æ„ã€‚
        *   `utils/` - å…¶ä»–å·¥å…·ã€‚
        *   `Keywords.py` - å…³é”®å­—ã€‚
    *   `page_objects/` - åç»­å‡çº§ POM ç”¨ã€‚
    *   `reports/` - æŠ¥å‘Šï¼Œè„šæœ¬ç”Ÿæˆçš„æŠ¥å‘Šå­˜æ”¾çš„åœ°æ–¹ï¼Œè®°å¾—ç”¨æµè§ˆå™¨æ‰“å¼€ã€‚
        *   `report_README.md` - æŠ¥å‘Šä½¿ç”¨è¯´æ˜ã€‚
    *   `test_data/` - å­˜æ”¾æµ‹è¯•æ–‡ä»¶ã€é…ç½®æµè§ˆå™¨æ‰“å¼€æ–¹å¼ã€‚
        *   `test_config.json` - é…ç½®æµè§ˆå™¨æ‰“å¼€æ–¹å¼ï¼Œæµ‹è¯•æ•°æ®æ–‡ä»¶è·¯å¾„ã€‚
    *   `tests/` - å…·ä½“å®ç°è„šæœ¬ã€‚
        *   `test_flows/` - æµ‹è¯•/è°ƒè¯•ä»£ç ã€‚
            *   `test_flow_by_function.py` - æ•´ä½“æµ‹è¯•å¿«é€Ÿè°ƒè¯•ç”¨ï¼Œå·²å¼ƒç”¨ã€‚
            *   `test_flow_by_function_json.py` - JSON è§£æã€`bat` è„šæœ¬ç›´æ¥è°ƒç”¨ã€‚
            *   `test_steps_by_session.py` - å•æ­¥æµ‹è¯•å¿«é€Ÿè°ƒè¯•ç”¨ï¼Œå·²å¼ƒç”¨ã€‚
            *   `test_steps_by_session_json.py` - JSON è§£æã€`bat` è„šæœ¬ç›´æ¥è°ƒç”¨ã€‚
        *   `conftest.py` - è„šæœ¬æµ‹è¯•é…ç½®ã€‚
    ---
	*   `.gitignore` - å¿½ç•¥æ–‡ä»¶ã€‚
	*   `requirements.txt` - å¾…å®‰è£…åº“ã€‚
	*   `install.bat` - #Windows ç¯å¢ƒå®‰è£…/æ›´æ–° ç¬¬ä¸€æ­¥ï¼ŒåŒå‡»è¿™ä¸ªæ–‡ä»¶ã€‚
	*   `main.bat` - #Windows å¯åŠ¨æµ‹è¯•è„šæœ¬ åç»­åªéœ€åŒå‡»è¿™é‡Œå³å¯å¼€å§‹æµ‹è¯•ã€‚
	*   `install.sh` - #macOS #Linux ç¯å¢ƒå®‰è£…/æ›´æ–° ç¬¬ä¸€æ­¥ï¼ŒåŒå‡»è¿™ä¸ªæ–‡ä»¶ã€‚
	*   `main.sh` - #macOS #Linux å¯åŠ¨æµ‹è¯•è„šæœ¬ åç»­åªéœ€åŒå‡»è¿™é‡Œå³å¯å¼€å§‹æµ‹è¯•ã€‚
	*   `README.md` - è¯»æˆ‘ã€‚
#### è„šæœ¬ä»‹ç»
- install.bat / install.sh
	- è‡ªåŠ¨æ ¹æ®requirements.txtä½¿ç”¨æ¸…åæºé•œåƒå®‰è£…è„šæœ¬æ‰€éœ€è™šæ‹Ÿç¯å¢ƒ
	- ä½¿ç”¨æ¸…åæºé•œåƒè‡ªåŠ¨å‡çº§pip
- main.bat / main.sh
	- **äº¤äº’å¼:**Â ç›´æ¥åŒå‡»`run_tests.bat`ï¼Œä¼šå‡ºç°èœå•
	- **éäº¤äº’å¼ (ç»™CI/CDæˆ–è‡ªåŠ¨åŒ–è„šæœ¬ç”¨):**
	    - `run_tests.bat 1` / Â `run_tests.sh 1` (æ‰§è¡ŒFunctionæ¨¡å¼)
	    - `run_tests.bat 2` / `run_tests.sh 2`Â (æ‰§è¡ŒSessionæ¨¡å¼)
	    - éäº¤äº’å¼æŠ¥å‘Šåç¼€ä¼šå¸¦ `_CI` å­—æ ·
	- ç›®å‰**æ”¯æŒçš„æ“ä½œ**ï¼š
    1. Functionæ¨¡å¼ (è½¯æ–­è¨€ï¼Œæ‰§è¡Œæ‰€æœ‰å¯ç”¨çš„æµç¨‹)
    2. Sessionæ¨¡å¼  (ç¡¬æ–­è¨€ï¼Œæ‰§è¡ŒæŒ‡å®šå¯ç”¨çš„æµç¨‹)
       ç¤ºä¾‹: 2 1 (æ‰§è¡Œç¬¬ä¸€ä¸ªæµç¨‹), 2 -1 (æ‰§è¡Œæœ€åä¸€ä¸ªæµç¨‹)
    3. Sessionæ¨¡å¼-Browsers (ç¡¬æ–­è¨€ï¼ŒæŒ‡å®šæµç¨‹åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸Šæ‰§è¡Œ)
       ç¤ºä¾‹: 3 1 (ç¬¬ä¸€ä¸ªæµç¨‹åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸Šæ‰§è¡Œ), 3 -1 (æœ€åä¸€ä¸ªæµç¨‹åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸Šæ‰§è¡Œ)
    4. Sessionæ¨¡å¼-All (ç¡¬æ–­è¨€ï¼Œæ‰§è¡Œæ‰€æœ‰å¯ç”¨çš„æµç¨‹)
    5. ä»ç°æœ‰Pythonæ–‡ä»¶è½¬æ¢æˆexcel
    6. å¯åŠ¨Playwrightå½•åˆ¶å¹¶è½¬æ¢excel
    7. æ¸…ç†æ®‹ç•™ä¸´æ—¶æ–‡ä»¶
#### ç›®å‰playwright-codegenå†…å½•**ä¸æ”¯æŒ**æˆ–å½•åˆ¶çš„åŠŸèƒ½
	è§†é¢‘æ’­æ”¾ï¼šä¸æ”¯æŒhtml5ï¼Œæ— æ³•æ”¯æŒbilibiliã€æŠ–éŸ³è¿™ç±»çš„è§†é¢‘ç½‘ç«™æ’­æ”¾
	barç±»æ§ä»¶ç²¾å‡†ç‚¹å‡»ï¼š
	    `page6.locator(".progress-bar.volumn-bar > .progress-track").click()`
	    `page6.locator(".progress-bar.volumn-bar > .progress-pass").click()`
	    - [ ] éŸ³é¢‘barç‚¹å‡»
	å…ƒç´ æ‹–æ‹½
	å…³é—­ç½‘é¡µé¡µé¢

